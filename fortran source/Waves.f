	program wave	parameter (ichange=100,jchange=100,iterate=900,c=0.7)	real Waves(ichange,jchange,3)        real x(ichange,jchange), y(ichange,jchange)        call getxy(x,y,ichange,jchange)	call Initdisturbance(waves,ichange,jchange,x,y)	do  i=1,iterate		call dumptofile(waves,ichange,jchange,i)	 	call fieldfile(i,ichange,jchange)		call generatewave(waves,ichange,jchange,c,i)		call changetime(waves,ichange,jchange)		write(*,*) i	end do	end	subroutine generatewave(waves,k,l,c,m)		dimension waves(k,l,3)		integer k,l		do i=2,k-1		  do j=2,l-1				term1=2*waves(i,j,2)-waves(i,j,1)			term2=(c**2)*(waves(i-1,j,2)-2*waves(i,j,2)+waves(i+1,j,2))			term3=(c**2)*(waves(i,j-1,2)-2*waves(i,j,2)+waves(i,j+1,2))			waves(i,j,3)=term1+term2+term3		  end do		end do		j=1		do i=2,k-1			term1=2*waves(i,j,2)-waves(i,j,1)			term2=(c**2)*(waves(i-1,j,2)-2*waves(i,j,2)+waves(i+1,j,2))			term3=(c**2)*(-2*waves(i,j,2)+2*waves(i,j+1,2))			waves(i,j,3)=term1+term2+term3		end do		j=l		do i=2,k-1			term1=2*waves(i,j,2)-waves(i,j,1)			term2=(c**2)*(waves(i-1,j,2)-2*waves(i,j,2)+waves(i+1,j,2))			term3=(c**2)*(2*waves(i,j-1,2)-2*waves(i,j,2))			waves(i,j,3)=term1+term2+term3		end do		i=1		do j=2,l-1			term1=2*waves(i,j,2)-waves(i,j,1)			term2=(c**2)*(-2*waves(i,j,2)+2*waves(i+1,j,2))			term3=(c**2)*(-2*waves(i,j,2)+waves(i,j-1,2)+waves(i,j+1,2))			waves(i,j,3)=term1+term2+term3		end do		i=k		do j=2,l-1			term1=2*waves(i,j,2)-waves(i,j,1)			term2=(c**2)*(2*waves(i-1,j,2)-2*waves(i,j,2))			term3=(c**2)*(-2*waves(i,j,2)+waves(i,j-1,2)+waves(i,j+1,2))			waves(i,j,3)=term1+term2+term3		end do		waves(1,1,3)=(waves(1,2,3)+waves(2,1,3)+waves(2,2,3))/3		waves(k,1,3)=(waves(k,2,3)+waves(k-1,1,3)+waves(k-1,2,3))/3		waves(k,l,3)=(waves(k,l-1,3)+waves(k-1,l,3)+waves(k-1,l-1,3))/3		waves(1,l,3)=(waves(1,l-1,3)+waves(2,l,3)+waves(2,l-1,3))/3	return	end	subroutine changetime(waves,k,l)		dimension waves(k,l,3)		do i=1,k		   do j=1,l			waves(i,j,1)=waves(i,j,2)			waves(i,j,2)=waves(i,j,3)			waves(i,j,3)=0		   end do		end do	return	end			subroutine initdisturbance(wave,k,l,x,y)		parameter (pi=3.14)		dimension wave(k,l,3),x(k,l),y(k,l)		real r		do i=1,k		do j=1,l			r=sqrt(x(i,j)**2+y(i,j)**2)			if (r.lt.(.25)) then				wave(i,j,1)=10*(cos(4*pi*r)+1)			else				wave(i,j,1)=0			end if			wave(i,j,2)=wave(i,j,1)		end do		end do	return	end	subroutine dumptofile(world,k,l,filnum)	dimension world(k,l,3)	integer filnum	character*12 fname	character*3 number		write(number,'(i3.3)') filnum	fname='wave.' // number // '.dat'     	open (45, file=fname, status='unknown')	do j=1,k	  do i=1,l	    write(45,*) world(i,j,2) 	  end do	end do	close(45)	return	end	subroutine  fieldfile(iteration,xdim,ydim)	integer iteration, xdim, ydim	character*12 fname,ofname	character*3 number	write(number,'(i3.3)') iteration	fname='wave.'//number//'.fld'	ofname='wave.'//number//'.dat'	open(11,file=fname,status='unknown')	write(11,40)40	format('# AVS')	write(11,50)50	format('ndim=2')	write(11,60) xdim60	format('dim1=',i4)	write(11,70) ydim70	format('dim2=',i4)	write(11,80)80	format('nspace=2')	write(11,90)90	format('veclen=1')	write(11,100)100	format('data=float')	write(11,110)110	format('field=uniform')	write(11,120) ofname120	format('variable 1 file=/storage/prj001/',a12,     -' filetype=ascii skip=0 offset=0 stride=1')	close(11)	return	end	subroutine getxy(x,y,k,l)		dimension x(k,l),y(k,l)		do i=1,k		do j=1,l			x(i,j)=(-0.3) +(1.0/k*(i-1.0))			y(i,j)=(-0.25) +(1.0/l*(j-1.0))		end do		end do	return	end