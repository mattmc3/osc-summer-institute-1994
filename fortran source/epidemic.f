       program Epidemic         parameter (IX=99)         parameter (IY=99)         parameter (IZ=99)         integer       x,y,z, p(ix,iy,iz)         real          prob, percentimmune         integer       numdead, killed, quitter, dieat, frames         write(*,*) 'PROBABILITY:'         read(*,*) prob         dieat=5         time2decay=-4         percentimmune=0.0         iseed=4343233         call ranset(iseed)         do x=1, ix         do y=1, iy         do z=1, iz           if (ranf().le.percentimmune) then             p(x,y,z) = 0           else             p(x,y,z) = 2           end if                  end do         end do         end do         p(int(ranf()*(ix-10)+5),int(ranf()*(iy-10)+5)     -   ,int(ranf()*(iz-10)+5))=3         p(int(ranf()*(ix-10)+5),int(ranf()*(iy-10)+5)     -   ,int(ranf()*(iz-10)+5))=3            p(int(ranf()*(ix-10)+5),int(ranf()*(iy-10)+5)     -   ,int(ranf()*(iz-10)+5))=3                    do while (quitter.eq.0)           frames=frames+1           killed=0           quitter=1           do x=2, ix-1           do y=2, iy-1           do z=2, iz-1             if (p(x,y,z).le.time2decay) then               p(x,y,z)=1             end if             if (p(x,y,z).le.-1) then                p(x,y,z)=p(x,y,z)-1             end if             if (p(x,y,z).ge.dieat) then               p(x,y,z)=-1                 killed=killed+1             end if             if (p(x,y,z).ge.3) then               p(x,y,z)=p(x,y,z)+1               quitter=0             end if           end do           end do           end do           do x=2, ix-1             do y=2, iy-1               do z=2, iz-1                 if ((p(x,y,z).ge.4).or.(p(x,y,z).le.-1)) then                    call spreadit(x,y,z,p,prob)                 end if                end do             end do           end doC          call display2d(p,frames)                    numdead=numdead+killed           write(*,*) 'Frame #', frames, ' - Killed this turn:', killed,     -     ' - Number dead: ', numdead                         call avs(frames,p)                    end do                 stop       end      subroutine avs(frames,p)        parameter (ix=99)        parameter (iy=99)        parameter (iz=99)         integer       p(ix,iy,iz)        integer       p2(ix,iy,iz)        character     filenm*17        character     cnum*5        integer       x,y,z,framesc     * output field file        write (cnum, '(i5.5)') frames        filenm = 'sick.' // cnum // '.vol'        open (7, file=filenm,form='UNFORMATTED',access='DIRECT',     -       RECL=ix*iy*iz+3, status='UNKNOWN')        filenm = 'sick.' // cnum // '.dat'        do z=1,iz          do y=1,iy            do x=1,ix              i=0c             *EXPERIMENTAL BOUNDING BOXc             *--------------------------------              if ((x.eq.1).or.(x.eq.ix)) then                 i=i+1               end if              if ((z.eq.1).or.(z.eq.iz)) then                 i=i+1              end if              if ((y.eq.1).or.(y.eq.iy)) then                 i=i+1              end if              c             *--------------------------------               if (p(x,y,z).eq.2) then                p2(x,y,z) = 50              else if ((p(x,y,z).eq.1).or.(p(x,y,z).le.-1)) then                p2(x,y,z) = 250               else if (p(x,y,z).ge.3) then                p2(x,y,z) = (p(x,y,z)-1)*50              end if              if (i.ge.2) then                p2(x,y,z) = 255              end if            end do          end do        end do        write (7,REC=1) char(ix),char(iy),char(iz),     -       (((char(p2(i,j,k)),i=1,ix),j=1,iy),k=1,iz)        close (7)      return      end                            subroutine spreadit(x,y,z,p,prob)         parameter (ix=99)         parameter (iy=99)         parameter (iz=99)         integer                p(ix,iy,iz),x,y,z         real                   prob         iseed=int(ranf()*1000)C        call ranset(iseed)C        TEST THE Z LEVEL         if (ranf().le.prob) then           if (p(x+1,y+1,z).eq.2) then             p(x+1,y+1,z)=3           end if         end if         if (ranf().le.prob) then           if (p(x-1,y+1,z).eq.2) then             p(x-1,y+1,z)=3           end if         end if         if (ranf().le.prob) then           if (p(x,y+1,z).eq.2) then             p(x,y+1,z)=3           end if         end if         if (ranf().le.prob) then           if (p(x+1,y-1,z).eq.2) then             p(x+1,y-1,z)=3           end if         end if         if (ranf().le.prob) then           if (p(x-1,y-1,z).eq.2) then             p(x-1,y-1,z)=3           end if         end if         if (ranf().le.prob) then           if (p(x,y-1,z).eq.2) then             p(x,y-1,z)=3           end if         end if         if (ranf().le.prob) then           if (p(x+1,y,z).eq.2) then             p(x+1,y,z)=3           end if         end if         if (ranf().le.prob) then           if (p(x-1,y,z).eq.2) then             p(x-1,y,z)=3           end if         end if       C        TEST THE Z+1 LEVEL         if (ranf().le.prob) then           if (p(x+1,y+1,z+1).eq.2) then             p(x+1,y+1,z+1)=3           end if         end if         if (ranf().le.prob) then                            if (p(x-1,y+1,z+1).eq.2) then             p(x-1,y+1,z+1)=3           end if         end if         if (ranf().le.prob) then           if (p(x,y+1,z+1).eq.2) then             p(x,y+1,z+1)=3           end if         end if         if (ranf().le.prob) then           if (p(x+1,y-1,z+1).eq.2) then             p(x+1,y-1,z+1)=3           end if         end if         if (ranf().le.prob) then           if (p(x-1,y-1,z+1).eq.2) then             p(x-1,y-1,z+1)=3           end if         end if         if (ranf().le.prob) then           if (p(x,y-1,z+1).eq.2) then             p(x,y-1,z+1)=3           end if         end if         if (ranf().le.prob) then           if (p(x+1,y,z+1).eq.2) then             p(x+1,y,z+1)=3           end if         end if         if (ranf().le.prob) then           if (p(x-1,y,z+1).eq.2) then             p(x-1,y,z+1)=3           end if         end ifC        TEST THE Z-1 LEVEL         if (ranf().le.prob) then           if (p(x+1,y+1,z-1).eq.2) then             p(x+1,y+1,z-1)=3           end if         end if         if (ranf().le.prob) then           if (p(x-1,y+1,z-1).eq.2) then             p(x-1,y+1,z-1)=3           end if         end if         if (ranf().le.prob) then           if (p(x,y+1,z-1).eq.2) then             p(x,y+1,z-1)=3           end if         end if         if (ranf().le.prob) then           if (p(x+1,y-1,z-1).eq.2) then             p(x+1,y-1,z-1)=3           end if         end if         if (ranf().le.prob) then           if (p(x-1,y-1,z-1).eq.2) then             p(x-1,y-1,z-1)=3           end if         end if         if (ranf().le.prob) then           if (p(x,y-1,z-1).eq.2) then             p(x,y-1,z-1)=3           end if         end if         if (ranf().le.prob) then           if (p(x+1,y,z-1).eq.2) then             p(x+1,y,z-1)=3           end if         end if         if (ranf().le.prob) then           if (p(x-1,y,z-1).eq.2) then             p(x-1,y,z-1)=3           end if         end if         return       endc       subroutine display2d(p,frames)c         c         parameter (ix=200)c         parameter (iy=200)c         parameter (iz=50)cc         integer                p(ix,iy,iz)c         integer                x, y, z,framesc         character*80           stringercc         z=35c         do y=1,iyc           do x=1, ixc             stringer(x:x) = char(48+p(x,y,z))c           end doc           write(*,*) stringerc         end doc         write(*,*) '----------------------------', framesc         read(*,*) xc         returnc       end